/* =========================================================
   11 — MATCHMAKING UI (Selettori preferenze + risultati)
   Dipendenze: 01-tokens.css (variabili), 02-base.css (reset)
   Naming: prefisso mm-
   ========================================================= */

/* ========== 1) SHELL / SEZIONE ====================================== */
.mm-section{
  background: var(--c-superficie);
  border: 1px solid var(--c-bordi);
  border-radius: var(--bordo-arrotondato);
  box-shadow: var(--ombra-card);
  padding: var(--spazio-md);
  margin: var(--spazio-md) auto;
  max-width: 1200px;
}

/* Titolo sezione */
.mm-title{
  font-family: var(--font-heading);
  font-weight: 800;
  font-size: clamp(1.2rem, 2.2vw, 1.6rem);
  color: var(--c-primario);
  margin-bottom: var(--spazio-sm);
}

/* ========== 2) TOOLBAR / PREFERENZE ================================ */
/* Striscia controlli (mood, temi, lingua, range compatibilità, ecc.) */
.mm-toolbar{
  display: grid;
  grid-template-columns: 1fr;
  gap: var(--spazio-sm);
  margin-bottom: var(--spazio-md);
}

/* Gruppo campo */
.mm-field{
  display: grid;
  gap: 6px;
}
.mm-label{
  font-size: .9rem;
  font-weight: 700;
  color: var(--c-testo);
}

/* Select + input + range coerenti con design system */
.mm-select,
.mm-input,
.mm-range{
  width: 100%;
  padding: .75rem .9rem;
  border: 1px solid var(--c-bordi);
  border-radius: 12px;
  background: var(--c-superficie);
  color: var(--c-testo);
  transition: var(--transizione);
  font: inherit;
}
.mm-select:focus,
.mm-input:focus{
  border-color: var(--c-primario);
  box-shadow: 0 0 0 3px rgba(76,175,80,.15);
  outline: none;
}

/* Range compatibilità */
.mm-range{
  appearance: none;
  height: 10px;
  border-radius: 999px;
  background: linear-gradient(90deg, var(--c-primario), color-mix(in oklab, var(--c-primario) 40%, white));
}
.mm-range::-webkit-slider-thumb{
  -webkit-appearance: none;
  appearance: none;
  width: 22px; height: 22px; border-radius: 50%;
  background: var(--c-primario);
  border: 2px solid #fff;
  box-shadow: 0 0 0 2px color-mix(in oklab, var(--c-primario) 40%, transparent);
  cursor: pointer;
}

/* Chip tags (temi poetici, forme, lingue) */
.mm-chips{ display: flex; flex-wrap: wrap; gap: 8px; }
.mm-chip{
  font-size: .8rem;
  padding: 6px 10px;
  border-radius: 999px;
  border: 1px solid var(--c-bordi);
  background: #fff;
  color: var(--c-testo-leggero);
  cursor: pointer;
  transition: var(--transizione);
  user-select: none;
}
.mm-chip:hover{ border-color: var(--c-primario); color: var(--c-primario); }
.mm-chip.is-active{
  border-color: var(--c-primario);
  color: #fff;
  background: var(--c-primario);
}

/* Azioni toolbar (reset, applica) */
.mm-toolbar-actions{
  display: flex; flex-wrap: wrap; gap: 8px; align-items: center;
}
.mm-btn{
  padding: .6rem .9rem;
  border-radius: 10px;
  border: 1px solid var(--c-bordi);
  background: var(--c-superficie);
  color: var(--c-testo);
  font-weight: 700; font-size: .92rem;
  cursor: pointer; transition: var(--transizione);
}
.mm-btn:hover{ border-color: var(--c-primario); color: var(--c-primario); }
.mm-btn--primary{ background: var(--c-primario); color: #fff; border-color: transparent; }
.mm-btn--primary:hover{ background: var(--c-primario-hover); }

/* Stato: toolbar bloccata se non loggato */
.mm-toolbar.is-locked{ position: relative; }
.mm-toolbar.is-locked::after{
  content: 'Accedi per usare il matchmaking';
  position: absolute; inset: 0; display: grid; place-items: center;
  background: rgba(255,255,255,.75);
  backdrop-filter: blur(2px);
  color: var(--c-testo-leggero);
  font-weight: 700;
  border-radius: 12px;
}

/* ========== 3) RISULTATI: GRIGLIA ================================== */
.mm-grid{
  display: grid;
  grid-template-columns: 1fr;
  gap: var(--spazio-md);
}

/* ========== 4) CARD MATCH ========================================== */
.mm-card{
  background: var(--c-superficie);
  border: 1px solid var(--c-bordi);
  border-radius: var(--bordo-arrotondato);
  box-shadow: var(--ombra-card);
  overflow: hidden;
  transition: transform .18s ease, box-shadow .18s ease, border-color .18s ease;
}
.mm-card:hover{
  transform: translateY(-2px);
  box-shadow: var(--ombra-intensa);
  border-color: color-mix(in oklab, currentColor 18%, transparent);
}

/* Header card */
.mm-card__header{
  display: grid;
  grid-template-columns: auto 1fr auto;
  align-items: center;
  gap: var(--spazio-sm);
  padding: var(--spazio-md);
}
.mm-avatar{
  width: 56px; height: 56px; border-radius: 50%;
  background: #eee center/cover no-repeat;
  border: 1px solid var(--c-bordi);
}
.mm-name{
  font-family: var(--font-heading);
  font-weight: 800;
  font-size: 1.05rem;
  color: var(--c-testo);
  line-height: 1.2;
}
.mm-handle{ font-size: .8rem; color: var(--c-testo-leggero); }

/* Compatibilità: pill + barra */
.mm-compat{
  display: grid; gap: 6px; justify-items: end;
}
.mm-compat__pill{
  font-size: .75rem; font-weight: 800;
  padding: 4px 10px; border-radius: 999px;
  border: 1px solid var(--c-bordi);
  color: var(--c-primario);
  background: color-mix(in oklab, var(--c-primario) 10%, #fff);
}
.mm-compat__bar{
  --val: 62%; /* aggiorna via style inline */
  width: 120px; height: 8px; border-radius: 999px; overflow: hidden;
  background: #eee; border: 1px solid var(--c-bordi);
  position: relative;
}
.mm-compat__bar::after{
  content: '';
  position: absolute; inset: 0;
  width: var(--val);
  background: linear-gradient(90deg, var(--c-primario), color-mix(in oklab, var(--c-primario) 40%, white));
}

/* Corpo card */
.mm-card__body{
  padding: 0 var(--spazio-md) var(--spazio-md);
  display: grid; gap: var(--spazio-sm);
}
.mm-meta{
  display: flex; flex-wrap: wrap; gap: 8px;
}
.mm-pill{
  font-size: .78rem; padding: 4px 8px; border-radius: 999px;
  border: 1px solid var(--c-bordi); background: #fff;
  color: var(--c-testo-leggero);
}

/* Tag temi in evidenza */
.mm-tags{ display: flex; flex-wrap: wrap; gap: 8px; }
.mm-tag{
  font-size: .78rem; padding: 4px 8px;
  border: 1px solid var(--c-bordi); border-radius: 999px;
  background: #fafafa; color: var(--c-testo);
}

/* Footer card (azioni) */
.mm-card__footer{
  padding: var(--spazio-md);
  border-top: 1px solid var(--c-bordi);
  background: #fcfcfc;
  display: flex; flex-wrap: wrap; gap: 8px; justify-content: space-between; align-items: center;
}
.mm-actions{ display: flex; flex-wrap: wrap; gap: 8px; }
.mm-qr{
  width: 64px; height: 64px;
  border: 1px solid var(--c-bordi);
  border-radius: 8px;
  background: #fff center/contain no-repeat;
  flex: 0 0 64px;
}

/* ========== 5) STATI (EMPTY/ERROR/SKELETON/LOCK) =================== */
.mm-empty,
.mm-error{
  display: grid; place-items: center;
  min-height: 160px;
  border: 2px dashed var(--c-bordi);
  border-radius: 12px;
  color: var(--c-testo-leggero);
}
.mm-skel{
  background: linear-gradient(90deg, #eee 25%, #f6f6f6 37%, #eee 63%);
  background-size: 400% 100%;
  animation: mmSkel 1.4s ease infinite;
  border-radius: 8px;
}
@keyframes mmSkel{
  0% { background-position: 100% 50%; }
  100%{ background-position: 0 50%; }
}

/* Blocca risultati se non loggato */
.mm-grid.is-locked{ position: relative; filter: blur(1px); }
.mm-grid.is-locked::after{
  content: 'Accedi per vedere i match';
  position: absolute; inset: 0; display: grid; place-items: center;
  background: rgba(255,255,255,.75); backdrop-filter: blur(2px);
  color: var(--c-testo-leggero); font-weight: 800; border-radius: 12px;
}

/* ========== 6) RESPONSIVE ========================================== */
/* Tablet ≥768px */
@media (min-width: 768px){
  .mm-toolbar{
    grid-template-columns: repeat(12, 1fr);
    align-items: end;
  }
  /* esempio layout: 6/3/3 colonne */
  .mm-col-6{ grid-column: span 6; }
  .mm-col-4{ grid-column: span 4; }
  .mm-col-3{ grid-column: span 3; }
  .mm-col-2{ grid-column: span 2; }

  .mm-grid{ grid-template-columns: repeat(2, minmax(0, 1fr)); }
}

/* Laptop ≥1024px */
@media (min-width: 1024px){
  .mm-grid{ grid-template-columns: repeat(3, minmax(0, 1fr)); }
}

/* Desktop largo ≥1440px */
@media (min-width: 1440px){
  .mm-grid{ grid-template-columns: repeat(4, minmax(0, 1fr)); }
}

/* ========== 7) A11Y & REDUCED MOTION =============================== */
@media (prefers-reduced-motion: reduce){
  .mm-card{ transition: none !important; }
}
.mm-card:focus-within{
  outline: 3px solid var(--c-secondario-hover);
  outline-offset: 2px; border-radius: 12px;
}

/* ========== 8) UTILITY LOCALI ====================================== */
.mm-hide-mobile{ display: none; }
@media (min-width: 768px){ .mm-hide-mobile{ display: inline-flex; } }

.mm-right{ margin-left: auto; }
.mm-center{ display: grid; place-items: center; }
